To do
=========
1. Rewrite in C
2. Keep the Java code around so no-one gets annoyed
